<!DOCTYPE html>
<html lang="en" xmlns:th = "http://www.thymeLeaf.org">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
<head>
    <meta charset="UTF-8">
    <title>Add item</title>
</head>
<body>
<div class="card-header"><h3 align="left">New Item</h3></div>

<div class="container">
    <form class="form-group" action="http://localhost:8080/mycollections/add/item/save" method="post" id="create_item">

        <input type="text" class="form-control" placeholder="Enter Item name" name="name">
        <div  style="display: flex; flex-wrap:wrap;flex-direction:row;border: 1px solid grey; border-radius:15px;" id="tags">
        </div>
        <input type="search" list="data" class="form-control" id="tag_add" placeholder="Enter Tag" required><br>
        <datalist id="data">
            <div style="display:none" th:each = "tag:${tags}">
                <option th:text = "${tag.name}"></option>
            </div>
        </datalist>
        <button class="btn btn-primary" onclick="addTag(event)">Add Tag</button> <!--- Add tag validation -->
        <input type="hidden" name="tags" id="tags_input">
        <input type="hidden" th:attr="value = ${col_id}" name="collectionId">

        <br><br>
        <button class="btn btn-success" onclick="prepare(event)">Create</button>

    </form>
</div>
<script language="JavaScript">



    function addTag(e){
    e.preventDefault();
    var tag = document.createElement("button");
    tag.innerHTML = document.getElementById("tag_add").value;
    tag.id = document.getElementById("tag_add").value;

     // answered Mar 27, 2013 at 1:09 by (Stack Overflow)
    tag.onclick = function(e) {
    e.preventDefault();
    this.parentNode.removeChild(this)
    };
    document.getElementById("tags").appendChild(tag);
    document.getElementById("tag_add").value = "";
    }


    function prepare(e){
    e.preventDefault();
    var tags = "";
    var div_tags = document.getElementById("tags");
    var data = div_tags.childNodes;
    for(let i = 1; i < data.length - 1; i++){
    tags += data[i].innerHTML + ",";
    }
    tags+= data[data.length-1].innerHTML;
    document.getElementById("tags_input").value = tags;
    alert(tags);
    document.getElementById("create_item").submit();

    }




</script>
</body>
</html>